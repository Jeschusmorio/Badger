<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="css/bootstrap.min.css" rel="stylesheet"/>
    <link href="css/style.css" rel="stylesheet"/>
    <title>Badger</title>
</head>
<body style="background-color: lightgrey;">
    <!--Container mit 1 row-->
    <div class="container-fluid vertical-center">
        <div class="row panel">
            <!--UserColumn mit eigener User, Kontakten und Settings-->
            <div class="col-md-3 bg-secondary" style="border-style: solid; border-radius: 5px; border-color: black;">
                <!--Eigener User-->
                <div class="row" style="border-bottom: solid; border-color: black;">
                    <div class="profile">
                        <img src="img/user.png" height="35px" width="35px">Mario Petrovic
                    </div>
                </div>
                <!--Contacts-->
                <div class="row constant-height">
                    <div class="contact-box flex-column">
                        <div class="profile contact" onclick="selectContact()">
                            <img src="img/user.png" height="35px" width="35px">Dummy
                        </div>
                        <div class="profile contact" onclick="selectContact()">
                            <img src="img/user.png" height="35px" width="35px">Dummy
                        </div>
                        <div class="profile contact" onclick="selectContact()">
                            <img src="img/user.png" height="35px" width="35px">Dummy
                        </div>
                        <div class="profile contact" onclick="selectContact()">
                            <img src="img/user.png" height="35px" width="35px">Dummy
                        </div>
                        <div class="profile contact" onclick="selectContact()">
                            <img src="img/user.png" height="35px" width="35px">Dummy
                        </div>
                        <div class="profile contact" onclick="selectContact()">
                            <img src="img/user.png" height="35px" width="35px">Dummy
                        </div>
                        <div class="profile contact" onclick="selectContact()">
                            <img src="img/user.png" height="35px" width="35px">Dummy
                        </div>
                        <div class="profile contact" onclick="selectContact()">
                            <img src="img/user.png" height="35px" width="35px">Dummy
                        </div>
                        <div class="profile contact" onclick="selectContact()">
                            <img src="img/user.png" height="35px" width="35px">Dummy
                        </div>
                        <div class="profile contact" onclick="selectContact()">
                            <img src="img/user.png" height="35px" width="35px">Dummy
                        </div>
                        <div class="profile contact" onclick="selectContact()">
                            <img src="img/user.png" height="35px" width="35px">Dummy
                        </div>
                        <div class="profile contact" onclick="selectContact()">
                            <img src="img/user.png" height="35px" width="35px">Dummy
                        </div>
                        <div class="profile contact" onclick="selectContact()">
                            <img src="img/user.png" height="35px" width="35px">Dummy
                        </div>
                        <div class="profile contact" onclick="selectContact()">
                            <img src="img/user.png" height="35px" width="35px">Dummy
                        </div>
                        <div class="profile contact" onclick="selectContact()">
                            <img src="img/user.png" height="35px" width="35px">Dummy
                        </div>
                    </div>
                </div>
                
                <!--Settings-->
                <div class="row justify-content-between" style="border-top: solid; border-color: black;">
                    <img src="img/addFriend.png" height="35px" width="35px">
                    <img src="img/removeFriend.png" height="35px" width="35px">
                    <a href="settings.html">
                        <img src="img/settings.png" height="35px" width="35px">
                    </a>
                </div>
            </div>
            <!--ChatColumn mit User, Messages und Textbar-->
            <div class="col-md-9 bg-secondary" style="border-style: solid; border-radius: 5px; border-color: black;">
                <!--Schreibpartner-->
                <div class="row" style="border-bottom: solid; border-color: black;">
                    <div class="profile">
                        <img src="img/user.png" height="35px" width="35px">Dummy
                    </div>
                </div>
                <!--Nachrichten-->
                <div id="message-box" class="row bg-light constant-height" style="overflow-y: scroll;">
                    <ul id="chat-messages"></ul>
                </div>
                <form action="">
                    <!--Textfeld-->
                    <div class="row bg-light" style="border-top: solid; border-color: black;">
                        <!--InputGroup = extension von form (hier: mit textfeld und button)-->
                        <div class="input-group">
				    	    <input id="message" type="text" class="form-control" placeholder="Send a message..." aria-label="message" aria-describedby="button-addon2">
				    	    <div class="input-group-append">
				    		    <button class="btn btn-outline-secondary" type="submit">Send</button>
				    	    </div>
				    	</div>
                    </div>
                </form>
            </div>
        </div>
    </div>
    <script src="build/index.js"></script>
    <script src="https://code.jquery.com/jquery.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"></script>
    <script src="ts/bootstrap.min.js"></script>
    <!--Client Library für socket.io-->
    <script src="node_modules/socket.io-client/dist/socket.io.js"></script>
    <script>
        //$ -> JQuery; $function -> die Funktion wird ausgeführt sobald alle Elemente geladen sind
        //JQuery-Syntax: $(Selector).function()
        $(function () {
            var socket = io();
            //EventHandler, wenn der Text der Form submitted wird
            $('form').submit(function(eventHandler) {
                eventHandler.preventDefault(); //Reload der Seite wird verhindert
                let message = $('#message').val();
                if (message != '') {
                    //ruft das Event 'chat-message' beim Server auf und sendet als Parameter die Nachricht
                    socket.emit('chat-message', message); 
                    $('#message').val(''); //das Textfeld wird entleert
                }
            });
            socket.on('chat-message', (message) => {
                $('#chat-messages').append('<li>' + message + '</li>');
                //JQuery.scrollTop(pxl) -> ändert Position der Scrollbar um die angegebene Pixelzahl nach unten
                //[0] -> wählt das DOM-Element aus (Document Object Model)
                //JS.scrollHeight -> liefert die tatsächliche Höhe der Elemente in der Scrollbar (auch unsichtbaren Content)
                $('#message-box').scrollTop($('#message-box')[0].scrollHeight); //falls neue Nachrichten kommen, ist die Scrollbar ganz unten
            });
        });
    </script>
</body>
</html>